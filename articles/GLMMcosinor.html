<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GLMMcosinor">
<title>GLMMcosinor • GLMMcosinor</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="GLMMcosinor">
<meta property="og:description" content="GLMMcosinor">
<meta property="og:image" content="https://docs.ropensci.org/GLMMcosinor/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.min.js">
</script><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">GLMMcosinor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="active nav-item">
  <a class="nav-link" href="../articles/GLMMcosinor.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-simulations.html">Simulating data</a>
    <a class="dropdown-item" href="../articles/mixed-models.html">Mixed models</a>
    <a class="dropdown-item" href="../articles/model-specification.html">Model specification</a>
    <a class="dropdown-item" href="../articles/model-visualisations.html">Visualising models</a>
    <a class="dropdown-item" href="../articles/multiple-components.html">Multicomponent cosinor modelling</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/GLMMcosinor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>GLMMcosinor</h1>
                        <h4 data-toc-skip class="author">Oliver Jayasinghe and Rex Parsons</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/GLMMcosinor/blob/HEAD/vignettes/GLMMcosinor.Rmd" class="external-link"><code>vignettes/GLMMcosinor.Rmd</code></a></small>
      <div class="d-none name"><code>GLMMcosinor.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="an-brief-introduction-to-the-cosinor-model">An brief introduction to the cosinor model<a class="anchor" aria-label="anchor" href="#an-brief-introduction-to-the-cosinor-model"></a>
</h2>
<p>A cosinor model aims to model the amplitude (<span class="math inline">\(A\)</span>), acrophase (<span class="math inline">\(\phi\)</span>), and MESOR (<span class="math inline">\(M\)</span>) of a rhythmic dataset.</p>
<ul>
<li><p>MESOR (<span class="math inline">\(M\)</span>) is the Midline Estimating Statistic of Rhythm, and may also be referred to as the equilibrium point.</p></li>
<li><p>Amplitude (<span class="math inline">\(A\)</span>) is the difference between the MESOR and the maximum height of the rhythm.</p></li>
<li><p>Acrophase (<span class="math inline">\(\phi\)</span>) is the phase at which the maximal response occurs.</p></li>
</ul>
<p>These could be modelled using a cosine function:</p>
<p><span class="math display">\[Y(t) = M + Acos(\frac{2\pi t}{\tau} - \phi) + e(t)\]</span> where <span class="math inline">\(e(t)\)</span> is the error term.</p>
<p>However, these cannot be estimated using a linear modelling framework! Other packages, including <a href="https://cran.r-project.org/package=circacompare" class="external-link"><code>{circacompare}</code></a> <span class="citation">(Parsons et al. 2020)</span>, fit this exact nonlinear model but most packages (including this one) decomposes this into linear terms, creating the cosinor model:</p>
<p><span class="math display">\[Y(t) = M + \beta x + \gamma z + e(t)\]</span></p>
<p>Where <span class="math inline">\(x =cos(\frac{2\pi t}{τ})\)</span>, <span class="math inline">\(z =sin(\frac{2\pi t}{τ})\)</span>, <span class="math inline">\(\beta = A cos(\phi)\)</span>, <span class="math inline">\(\gamma = A sin(\phi)\)</span></p>
<p>This linear model is passed to the package <a href="https://cran.r-project.org/package=glmmTMB" class="external-link"><code>{glmmTMB}</code></a> <span class="citation">(Brooks et al. 2017)</span> in <code>lme4</code> syntax. If the model has no random effects, <code>glmmTMB</code> uses maximum likelihood estimation to estimate the linear coefficients of the model. For models with random effects, a Laplace approximation is used to integrate over the random effects. This approximation is handled by the <a href="https://cran.r-project.org/package=TMB" class="external-link"><code>{TMB}</code></a><span class="citation">(Kristensen et al. 2016)</span> package which uses automatic differentiation of the joint likelihood function to provide fast computations of parameter estimates. A detailed explanation of this process is described <a href="https://doi.org/10.18637/jss.v070.i05" class="external-link">here</a> <span class="citation">(Kristensen et al. 2016)</span></p>
<p><code>glmmTMB</code> returns the estimates of the linear coefficients from the linear model. To recover the estimates of the original parameters for amplitude (<span class="math inline">\(A\)</span>) and acrophase (<span class="math inline">\(\phi\)</span>), the estimates for <span class="math inline">\(\hat\beta\)</span> and <span class="math inline">\(\hat\gamma\)</span> must be transformed as per the following equations:</p>
<p><span class="math display">\[\hat\phi = \arctan(\frac{\hat\gamma}{\hat\beta}) \]</span></p>
<p><span class="math display">\[\hat A = \sqrt{\hat\beta ^2 + \hat\gamma ^ 2}\]</span> These transformed parameters for acrophase and amplitude, along with MESOR are returned as part of the <code>cglmm</code> output. For a more thorough introduction to cosinor modelling, see <a href="https://doi.org/10.1186%2F1742-4682-11-16" class="external-link">here</a> <span class="citation">(Cornelissen 2014)</span>.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><a href="https://docs.ropensci.org/GLMMcosinor">GLMMcosinor</a> allows the user to fit generalised linear models based on rhythmic data with a cosinor model. It allows users to summarise, predict, and plot these models too. Existing packages have focused primarily on Gaussian data. Some circadian regression modelling packages have allowed users to specify generalised linear models, but with limited flexibility. <a href="https://docs.ropensci.org/GLMMcosinor">GLMMcosinor</a> takes a comprehensive approach to modelling by harnessing the <a href="https://github.com/glmmTMB/glmmTMB" class="external-link">glmmTMB</a> package, that has a wide range of available link functions, allowing users to model rhythmic data from a wide range of distributions (for full list - see <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">?family</a></code> and <code><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html" class="external-link">?glmmTMB::family_glmmTMB</a></code>) including:</p>
<ul>
<li>Binomial</li>
<li>Guassian</li>
<li>Inverse Gaussian</li>
<li>Gamma</li>
<li>Poisson</li>
<li>Negative Binomial</li>
</ul>
<p>The table below shows what features are available within <a href="https://docs.ropensci.org/GLMMcosinor">GLMMcosinor</a> and other methods.</p>
<div class="figure">
<img src="../reference/figures/methods-table.png" style="width:100.0%" alt=""><p class="caption">flextable methods</p>
</div>
</div>
<div class="section level2">
<h2 id="cglmm">
<code>cglmm()</code><a class="anchor" aria-label="anchor" href="#cglmm"></a>
</h2>
<p><code><a href="../reference/cglmm.html">cglmm()</a></code> wrangles the data appropriately to fit the cosinor model given the formula specified by the user. It returns a model, providing estimates of amplitude, acrophase, and MESOR (Midline Statistic Of Rhythm).</p>
<p>The formula argument for <code><a href="../reference/cglmm.html">cglmm()</a></code> is specified using the <a href="https://github.com/lme4/lme4/" class="external-link">lme4</a> style (for details see <code><a href="https://cran.rstudio.com/web/packages/lme4/vignettes/lmer.pdf" class="external-link">vignette("lmer", package = "lme4")</a></code>). The only difference is that it allows for use of <code><a href="../reference/amp_acro.html">amp_acro()</a></code> within the formula that is used to identify the cosinor (rhythmic) components and relevant variables in the provided data. Any other combination of covariates can also be included in the formula as well as random effects. Additionally, zero-inflation (<code>ziformula</code>) and dispersion (<code>dispformula</code>) formulae can be incorporated if required. For detailed examples of how to specify these types of models, see the <a href="https://docs.ropensci.org/GLMMcosinor/articles/mixed-models.html">mixed-models</a>, <a href="https://docs.ropensci.org/GLMMcosinor/articles/model-specification.html">model-specification</a> and <a href="https://docs.ropensci.org/GLMMcosinor/articles/multiple-components.html">multiple-components</a> vignettes.</p>
<p>For example, consider the following model and its output:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/GLMMcosinor">GLMMcosinor</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">cosinor_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">vit_d</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">vitamind</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Notice how both the raw and transformed coefficients are provided as output. The adapted <code>data.frame</code> that was used to fit the raw model can be accessed from the model and includes <code>main_rrr1</code> and <code>main_sss1</code> columns of data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cosinor_model</span><span class="op">$</span><span class="va">newdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;      vit_d      time X  main_rrr1  main_sss1</span></span>
<span><span class="co">#&gt; 1 16.12091 11.439525 0  0.9572476 -0.2892699</span></span>
<span><span class="co">#&gt; 2 29.90624  5.807104 0 -0.9949038  0.1008285</span></span>
<span><span class="co">#&gt; 3 39.17572  1.045492 1  0.8538711  0.5204846</span></span>
<span><span class="co">#&gt; 4 35.15403  4.082983 1 -0.5371451  0.8434899</span></span>
<span><span class="co">#&gt; 5 43.67065 10.606247 1  0.7453295 -0.6666963</span></span>
<span><span class="co">#&gt; 6 31.20360  5.126054 0 -0.8971168  0.4417935</span></span></code></pre></div>
<p>In this example, the <code>main</code> prefix indicates that this is the data for the conditional model, as opposed to (potential) dispersion or zero-inflation models, which have the prefixes <code>disp</code> and <code>zi</code>, respectively. The numeric suffix, indicates that this is the data for the first (and only) cosinor component. If there are multiple components, the columns of data will be named accordingly.</p>
</div>
<div class="section level2">
<h2 id="a-basic-overview-of-cglmm">A basic overview of <code>cglmm()</code><a class="anchor" aria-label="anchor" href="#a-basic-overview-of-cglmm"></a>
</h2>
<p>The <code><a href="../reference/cglmm.html">cglmm()</a></code> function is used to fit cosinor models to a variety of distributions using the <code>glmmTMB()</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">vit_d</span> <span class="op">~</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, period <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">vitamind</span>,</span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; vit_d ~ main_rrr1 + main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 30.25467</span></span>
<span><span class="co">#&gt; main_rrr1    2.59418</span></span>
<span><span class="co">#&gt; main_sss1    5.75079</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 30.25467</span></span>
<span><span class="co">#&gt; amp          6.30883</span></span>
<span><span class="co">#&gt; acr          1.14703</span></span></code></pre></div>
<ul>
<li>
<code>formula</code>: A formula specifying the model structure, including the response variable and the cosinor components (using <code><a href="../reference/amp_acro.html">amp_acro()</a></code>).</li>
<li>
<code>data</code>: The <code>data.frame</code> containing the variables used in the formula.</li>
<li>
<code>family</code>: The family of the distribution for the response variable (e.g., poisson, gaussian, or any family found in<code><a href="https://rdrr.io/r/stats/family.html" class="external-link">?family</a></code> and <code><a href="https://rdrr.io/pkg/glmmTMB/man/nbinom2.html" class="external-link">?glmmTMB::family_glmmTMB</a></code>)</li>
</ul>
<p>The <code><a href="../reference/amp_acro.html">amp_acro()</a></code> function is used within the formula to specify the cosinor components. It allows you to specify the period of the rhythm and, if necessary, the grouping structure and the number of components. The arguments of <code><a href="../reference/amp_acro.html">amp_acro()</a></code> are:</p>
<ul>
<li>
<code>group</code>: The name of the grouping variable in the dataset.</li>
<li>
<code>time_col</code>: The name of the time column.</li>
<li>
<code>n_components</code>: The number of components in the cosinor model.</li>
<li>
<code>period</code>: The period(s) of the rhythm.</li>
</ul>
<div class="section level3">
<h3 id="understanding-the-output">Understanding the output<a class="anchor" aria-label="anchor" href="#understanding-the-output"></a>
</h3>
<p>The most relevant output from the <code><a href="../reference/cglmm.html">cglmm()</a></code> function is likely to be the parameter estimates for MESOR, amplitude, and acrophase under the ‘Transformed Coefficients’ heading. These are the recovered estimates mentioned at the beginning of this vignette: the amplitude and phase. The ‘Raw Coefficients’ are the coefficients from the cosinor model. In this example, the <code>main_rrr1</code> and <code>main_sss1</code> correspond to <span class="math inline">\(\hat\beta\)</span> and <span class="math inline">\(\hat\gamma\)</span> in the first section, respectively.</p>
<p>The following example fits a grouped single-component model with a Guassian distribution (the default).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">vit_d</span> <span class="op">~</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="st">"X"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">vitamind</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; vit_d ~ X + X:main_rrr1 + X:main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  29.68980</span></span>
<span><span class="co">#&gt; X1            1.90186</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.93079</span></span>
<span><span class="co">#&gt; X1:main_rrr1  6.51029</span></span>
<span><span class="co">#&gt; X0:main_sss1  6.20099</span></span>
<span><span class="co">#&gt; X1:main_sss1  4.81846</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept) 29.68980</span></span>
<span><span class="co">#&gt; [X=1]        1.90186</span></span>
<span><span class="co">#&gt; [X=0]:amp    6.27046</span></span>
<span><span class="co">#&gt; [X=1]:amp    8.09947</span></span>
<span><span class="co">#&gt; [X=0]:acr    1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr    0.63715</span></span></code></pre></div>
<p>Under the ‘Transformed Coefficients’ heading:</p>
<ul>
<li><p><code>(Intercept) = 29.6898</code>is the MESOR estimate of group 0</p></li>
<li><p><code>[X=1] = 1.90186</code> is the difference between the MESOR estimates of group 1 and 2 *</p></li>
<li><p><code>[X=0]:amp = 6.27046</code> is the amplitude estimate for group 0</p></li>
<li><p><code>[X=1]:amp = 8.09947</code> is the amplitude estimate for group 1</p></li>
<li><p><code>[X=0]:acr = 1.42181</code> is the acrophase estimate in radians for group 0 **</p></li>
<li><p><code>[X=1]:acr = 0.63715</code> is the acrophase estimate in radians for group 1</p></li>
</ul>
<p>* Hence, the MESOR estimate for group 1 would be <code>29.6898 + 1.90186 = 31.59166</code>. This is due to the behaviour of the <code>glmmTMB()</code> function. This can be adjusted by adding a <code>0 +</code> to the beginning of the formula:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">vit_d</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>    period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"X"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">vitamind</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; vit_d ~ X + X:main_rrr1 + X:main_sss1 - 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;              Estimate</span></span>
<span><span class="co">#&gt; X0           29.68980</span></span>
<span><span class="co">#&gt; X1           31.59165</span></span>
<span><span class="co">#&gt; X0:main_rrr1  0.93079</span></span>
<span><span class="co">#&gt; X1:main_rrr1  6.51029</span></span>
<span><span class="co">#&gt; X0:main_sss1  6.20101</span></span>
<span><span class="co">#&gt; X1:main_sss1  4.81847</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;           Estimate</span></span>
<span><span class="co">#&gt; [X=0]     29.68980</span></span>
<span><span class="co">#&gt; [X=1]     31.59165</span></span>
<span><span class="co">#&gt; [X=0]:amp  6.27048</span></span>
<span><span class="co">#&gt; [X=1]:amp  8.09948</span></span>
<span><span class="co">#&gt; [X=0]:acr  1.42181</span></span>
<span><span class="co">#&gt; [X=1]:acr  0.63716</span></span></code></pre></div>
<p>Note how now, <code>[X=1] = 31.59165</code> and this represents the estimate for the MESOR for group 1, rather than the difference.</p>
<p>** Note how the acrophase is provided in units of radians. Since the period is 12, an acrophase of 1.42181 radians corresponds to a time of <span class="math inline">\(\frac{1.42181}{2 \pi} \times 12 = 2.715457\)</span>. This means the maximum response occurs at 2.715 time units. We can check this visually using the <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> function, looking at the <code>[X=0]</code> level (red line)</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cosinor_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">vit_d</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">X</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">time</span>,</span>
<span>    period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"X"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">vitamind</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">cosinor_model</span>, predict.ribbon <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GLMMcosinor_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="more-advanced-cglmm-model-specification">More advanced <code>cglmm()</code> model specification<a class="anchor" aria-label="anchor" href="#more-advanced-cglmm-model-specification"></a>
</h2>
<p>The <code><a href="../reference/cglmm.html">cglmm()</a></code> function allows you to specify different types of cosinor models with or without grouping variables. The function can also generate dispersion models and zero-inflation models. For more detailed explanations and examples, see the <a href="https://docs.ropensci.org/GLMMcosinor/articles/model-specification.html">model-specification</a> article.</p>
<p>Additionally, the <code><a href="../reference/cglmm.html">cglmm()</a></code> function provides more advanced functionality for multi-component models, and detailed explanations can be found in the <a href="https://docs.ropensci.org/GLMMcosinor/articles/multiple-components.html">multiple-components</a> article.</p>
<p>The <code><a href="../reference/cglmm.html">cglmm()</a></code> function also allows mixed model specification. See the <a href="https://docs.ropensci.org/GLMMcosinor/articles/mixed-models.html">mixed-models</a> article for more details.</p>
</div>
<div class="section level2">
<h2 id="using-summary-and-testing-for-differences-between-estimates">Using <code>summary()</code> and testing for differences between estimates<a class="anchor" aria-label="anchor" href="#using-summary-and-testing-for-differences-between-estimates"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method for the outputs from <code><a href="../reference/cglmm.html">cglmm()</a></code> provides a more detailed summary of the model and its parameter estimates and uncertainty. It outputs the estimates, standard errors, confidence intervals, and p-values for both the raw model parameters and the transformed parameters. The summary statistics do not represent a comparison between any groups for the cosinor components - that is the role of the <code><a href="../reference/test_cosinor_components.html">test_cosinor_components()</a></code> and <code><a href="../reference/test_cosinor_levels.html">test_cosinor_levels()</a></code> functions.</p>
<p>Here is an example of how to use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> with some simulated data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span></span>
<span>  <span class="fl">1000</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  amp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  acro <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>, period <span class="op">=</span> <span class="fl">12</span>, group <span class="op">=</span> <span class="st">"group"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata_simple</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                      estimate standard.error     lower.CI upper.CI    p.value</span></span>
<span><span class="co">#&gt; (Intercept)       4.998454142    0.003463730  4.991665356  5.00524 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1           -1.002150001    0.005937109 -1.013786521 -0.99051 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr1  1.082281784    0.003347565  1.075720677  1.08884 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_rrr1  0.876651963    0.006198710  0.864502714  0.88880 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_sss1  1.682350718    0.003919418  1.674668800  1.69003 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss1  0.481951763    0.005936670  0.470316104  0.49359 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt;                     </span></span>
<span><span class="co">#&gt; (Intercept)      ***</span></span>
<span><span class="co">#&gt; group1           ***</span></span>
<span><span class="co">#&gt; group0:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group0:main_sss1 ***</span></span>
<span><span class="co">#&gt; group1:main_sss1 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                    estimate standard.error     lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)     4.998454142    0.003463730  4.991665356  5.00524 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]      -1.002150001    0.005937109 -1.013786521 -0.99051 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp1  2.000409408    0.004275553  1.992029478  2.00879 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp1  1.000398004    0.006379631  0.987894156  1.01290 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr1  0.999134804    0.001439122  0.996314177  1.00196 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr1  0.502662067    0.005739524  0.491412807  0.51391 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>If we wanted to test the difference between the amplitude estimate for component 1 between <code>group 1</code> and <code>group 2</code>, we can use the <code><a href="../reference/test_cosinor_levels.html">test_cosinor_levels()</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/test_cosinor_levels.html">test_cosinor_levels</a></span><span class="op">(</span><span class="va">object</span>, x_str <span class="op">=</span> <span class="st">"group"</span>, param <span class="op">=</span> <span class="st">"amp"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Test Details: </span></span>
<span><span class="co">#&gt; Parameter being tested:</span></span>
<span><span class="co">#&gt; Amplitude</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparison type:</span></span>
<span><span class="co">#&gt; levels</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Grouping variable used for comparison between groups: group</span></span>
<span><span class="co">#&gt; Reference group: 0</span></span>
<span><span class="co">#&gt; Comparator group: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; cglmm model only has a single component and to compare</span></span>
<span><span class="co">#&gt;           between groups.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test: </span></span>
<span><span class="co">#&gt; Statistic: </span></span>
<span><span class="co">#&gt; 16955.27</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P-value: </span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Individual tests:</span></span>
<span><span class="co">#&gt; Statistic: </span></span>
<span><span class="co">#&gt; -130.21</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P-value: </span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate and 95% confidence interval:</span></span>
<span><span class="co">#&gt; -1 (-1.02 to -0.98)</span></span></code></pre></div>
<p>The estimate here is the estimate of the difference between the inputted values, along with its confidence interval. The real parameters for <code>amp</code> in the first component were 2 and 1 for groups 0 and 1 respectively, and so the difference is approximately -1.</p>
<p>Now, consider an example where the difference is not so clear.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata_poisson</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span><span class="fl">100</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4.4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.46</span><span class="op">)</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cosinor_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata_poisson</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/test_cosinor_levels.html">test_cosinor_levels</a></span><span class="op">(</span></span>
<span>  <span class="va">cosinor_model</span>,</span>
<span>  x_str <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  param <span class="op">=</span> <span class="st">"amp"</span>,</span>
<span>  component_index <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Test Details: </span></span>
<span><span class="co">#&gt; Parameter being tested:</span></span>
<span><span class="co">#&gt; Amplitude</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparison type:</span></span>
<span><span class="co">#&gt; levels</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Grouping variable used for comparison between groups: group</span></span>
<span><span class="co">#&gt; Reference group: 0</span></span>
<span><span class="co">#&gt; Comparator group: 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; cglmm model has2 components. Component 1 is being used for comparison between groups.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test: </span></span>
<span><span class="co">#&gt; Statistic: </span></span>
<span><span class="co">#&gt; 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P-value: </span></span>
<span><span class="co">#&gt; 0.8245</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Individual tests:</span></span>
<span><span class="co">#&gt; Statistic: </span></span>
<span><span class="co">#&gt; -0.22</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P-value: </span></span>
<span><span class="co">#&gt; 0.8245</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate and 95% confidence interval:</span></span>
<span><span class="co">#&gt; 0 (-0.04 to 0.03)</span></span></code></pre></div>
<p>In this example, there is no significant difference in the estimate of <code>amp</code> for the first component between the reference group and the comparator group. Also notice how if we are comparing between levels, we should keep the component the same, and that is what <code>component_index</code> sets. Likewise, when we test between components using <code><a href="../reference/test_cosinor_components.html">test_cosinor_components()</a></code>, we can indicate which level this comparison occurs using <code>level_index</code>. There may be multiple <code>groups</code>, in which case we can fix the <code>group</code> using the <code>x_str</code> argument.</p>
<p>As an example of testing the difference between components for the same level:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/test_cosinor_components.html">test_cosinor_components</a></span><span class="op">(</span></span>
<span>  <span class="va">cosinor_model</span>,</span>
<span>  x_str <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  param <span class="op">=</span> <span class="st">"acr"</span>,</span>
<span>  level_index <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Test Details: </span></span>
<span><span class="co">#&gt; Parameter being tested:</span></span>
<span><span class="co">#&gt; Acrophase</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparison type:</span></span>
<span><span class="co">#&gt; components</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Component indices used for comparison between groups: group</span></span>
<span><span class="co">#&gt; Reference component: 1</span></span>
<span><span class="co">#&gt; Comparator component: 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test: </span></span>
<span><span class="co">#&gt; Statistic: </span></span>
<span><span class="co">#&gt; 154.29</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P-value: </span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Individual tests:</span></span>
<span><span class="co">#&gt; Statistic: </span></span>
<span><span class="co">#&gt; -12.42</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P-value: </span></span>
<span><span class="co">#&gt; 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimate and 95% confidence interval:</span></span>
<span><span class="co">#&gt; -1.89 (-2.19 to -1.59)</span></span></code></pre></div>
<p>In this situation, there is a significant difference between the acrophase for the comparator group between its two components.</p>
</div>
<div class="section level2">
<h2 id="using-predict">Using <code>predict()</code><a class="anchor" aria-label="anchor" href="#using-predict"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> method allows users to get predicted values from the model on either the existing or new data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>predictions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">cosinor_model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>, <span class="va">testdata_poisson</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   predictions    Y     times group</span></span>
<span><span class="co">#&gt; 1    865.8332  871 17.009450     0</span></span>
<span><span class="co">#&gt; 2    701.2750  714 10.503837     0</span></span>
<span><span class="co">#&gt; 3    798.4445  861  4.800118     0</span></span>
<span><span class="co">#&gt; 4   1551.0482 1541 18.409584     0</span></span>
<span><span class="co">#&gt; 5   1733.9702 1699 12.315885     0</span></span>
<span><span class="co">#&gt; 6   1972.1517 1951  1.072893     0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="plotting-cglmm-objects">Plotting <code>cglmm</code> objects<a class="anchor" aria-label="anchor" href="#plotting-cglmm-objects"></a>
</h2>
<p>The <a href="https://docs.ropensci.org/GLMMcosinor">GLMMcosinor</a> package includes two ways to visualise <code><a href="../reference/cglmm.html">cglmm()</a></code> objects. Firstly, the <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code> method creates a time-response plot of the fitted model for all groups:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">cosinor_model</span>, superimpose.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GLMMcosinor_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>This function also allows users to superimpose the data (that was used to fit the model) over the fitted model, using the <code>superimpose.data = TRUE</code>, as demonstrated above. By default, the generated plot will have x-limits corresponding to the minimum and maximum values of the time-vector in the original dataframe, although the x-limits can be manually defined by the user using the <code>xlims</code> argument. The details of using the <code>autoplot</code> function are found in the <a href="https://docs.ropensci.org/GLMMcosinor/articles/model-visualisations.html">model-visualisations</a> vignette.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-brooks2017glmmTMB" class="csl-entry">
Brooks, Mollie E., Kasper Kristensen, Koen J. van Benthem, Arni Magnusson, Casper W. Berg, Anders Nielsen, Hans J. Skaug, Martin Maechler, and Benjamin M. Bolker. 2017. <span>“<span class="nocase">glmmTMB</span> Balances Speed and Flexibility Among Packages for Zero-Inflated Generalized Linear Mixed Modeling.”</span> <em>The R Journal</em> 9 (2): 378–400. <a href="https://doi.org/10.32614/RJ-2017-066" class="external-link">https://doi.org/10.32614/RJ-2017-066</a>.
</div>
<div id="ref-cornelissen2014cosinor" class="csl-entry">
Cornelissen, Germaine. 2014. <span>“Cosinor-Based Rhythmometry.”</span> <em>Theoretical Biology and Medical Modelling</em> 11 (1): 1–24.
</div>
<div id="ref-Kristensen2016TMB" class="csl-entry">
Kristensen, Kasper, Anders Nielsen, Casper W. Berg, Hans Skaug, and Bradley M. Bell. 2016. <span>“TMB: Automatic Differentiation and Laplace Approximation.”</span> <em>Journal of Statistical Software</em> 70 (5): 1–21. <a href="https://doi.org/10.18637/jss.v070.i05" class="external-link">https://doi.org/10.18637/jss.v070.i05</a>.
</div>
<div id="ref-parsons2020circacompare" class="csl-entry">
Parsons, Rex, Richard Parsons, Nicholas Garner, Henrik Oster, and Oliver Rawashdeh. 2020. <span>“CircaCompare: A Method to Estimate and Statistically Support Differences in Mesor, Amplitude and Phase, Between Circadian Rhythms.”</span> <em>Bioinformatics</em> 36 (4): 1208–12.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
