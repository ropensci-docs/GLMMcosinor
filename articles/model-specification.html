<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="GLMMcosinor">
<title>Model specification • GLMMcosinor</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model specification">
<meta property="og:description" content="GLMMcosinor">
<meta property="og:image" content="https://docs.ropensci.org/GLMMcosinor/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Mathjax --><script type="text/javascript" id="MathJax-script" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.min.js">
</script><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">GLMMcosinor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/GLMMcosinor.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data-simulations.html">Simulating data</a>
    <a class="dropdown-item" href="../articles/mixed-models.html">Mixed models</a>
    <a class="dropdown-item" href="../articles/model-specification.html">Model specification</a>
    <a class="dropdown-item" href="../articles/model-visualisations.html">Visualising models</a>
    <a class="dropdown-item" href="../articles/multiple-components.html">Multicomponent cosinor modelling</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/GLMMcosinor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model specification</h1>
                        <h4 data-toc-skip class="author">Oliver Jayasinghe and Rex Parsons</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/GLMMcosinor/blob/HEAD/vignettes/model-specification.Rmd" class="external-link"><code>vignettes/model-specification.Rmd</code></a></small>
      <div class="d-none name"><code>model-specification.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/GLMMcosinor">GLMMcosinor</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="cglmm">
<code>cglmm()</code><a class="anchor" aria-label="anchor" href="#cglmm"></a>
</h2>
<p><code><a href="../reference/cglmm.html">cglmm()</a></code> wrangles the data appropriately to fit the cosinor model given the formula specified by the user. It provides estimates of amplitude, acrophase, and MESOR (Midline Statistic Of Rhythm).</p>
<p>The formula argument for <code><a href="../reference/cglmm.html">cglmm()</a></code> is specified using the <a href="https://github.com/lme4/lme4/" class="external-link">lme4</a> style (for details see <code><a href="https://cran.rstudio.com/web/packages/lme4/vignettes/lmer.pdf" class="external-link">vignette("lmer", package = "lme4")</a></code>). The only difference is that it allows for use of an <code><a href="../reference/amp_acro.html">amp_acro()</a></code> call within the formula that is used to identify the circadian components and relevant variables in the <code>data.frame</code>. Any other combination of covariates can also be included in the formula as well as random effects and zero-inflation (<code>ziformula</code>) and dispersion (<code>dispformula</code>) formulae. For detailed examples of how to specify models, see the <a href="https://docs.ropensci.org/GLMMcosinor/articles/mixed-models.html">mixed-models</a>, <a href="https://docs.ropensci.org/GLMMcosinor/articles/model-specification.html">model-specification</a> and <a href="https://docs.ropensci.org/GLMMcosinor/articles/multiple-components.html">multiple-components</a> vignettes.</p>
</div>
<div class="section level2">
<h2 id="using-cglmm">Using cglmm()<a class="anchor" aria-label="anchor" href="#using-cglmm"></a>
</h2>
<p>The following examples use data simulated by the the <code>simulate_cosinor</code> function.</p>
<div class="section level3">
<h3 id="specifying-a-single-component-model-with-no-grouping-variable">Specifying a single-component model with no grouping variable<a class="anchor" aria-label="anchor" href="#specifying-a-single-component-model-with-no-grouping-variable"></a>
</h3>
<p>Here, we fit a simple cosinor model to “testdata_simple” - simulated data from a Poisson distribution loaded in this vignette. In this example, there is no grouping variable.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span></span>
<span>  <span class="fl">1000</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  amp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  acro <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    period <span class="op">=</span> <span class="fl">12</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">testdata_simple</span>, <span class="va">group</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ main_rrr1 + main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  4.99845</span></span>
<span><span class="co">#&gt; main_rrr1    1.08228</span></span>
<span><span class="co">#&gt; main_sss1    1.68235</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;             Estimate</span></span>
<span><span class="co">#&gt; (Intercept)  4.99845</span></span>
<span><span class="co">#&gt; amp          2.00041</span></span>
<span><span class="co">#&gt; acr          0.99913</span></span></code></pre></div>
<p>The output shows the estimates for the raw coefficients in addition to the transformed estimates for amplitude (amp) and acrophase (acr) and MESOR (<code>(Intercept)</code>). The previous section of this vignette: <a href="https://docs.ropensci.org/GLMMcosinor/articles/GLMMcosinor.html#an-overview-of-the-statistical-methods-used-for-parameter-estimation">An overview of the statistical methods used for parameter estimation</a> outlines the difference between the raw coefficients and the transformed coefficients.</p>
<p>We would interpret the output as follows:</p>
<ul>
<li><p><code>MESOR estimate = 4.99845</code></p></li>
<li><p><code>Amplitude estimate = 1.08228</code></p></li>
<li><p><code>Acrophase estimate = 0.99913</code></p></li>
</ul>
<p>Note that this estimate is in radians to align with conventions. To interpret this, we can express <code>0.99913 radians</code> as a fraction of the total <span class="math inline">\(2\pi\)</span> and multiply by the period to get the time when the response is a maximal. Hence, <span class="math inline">\(\frac{0.99913}{2\pi} \times 12 = 1.908\)</span> in the units of the <code>time_col</code> column in the original dataframe. This is saying that the peak response would occur after 1.908 time-units and every 12 time-units after this. We can confirm this by plotting:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span>, superimpose.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="model-specification_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="specifying-a-single-component-model-with-a-grouping-variable-and-a-shared-mesor">Specifying a single-component model with a grouping variable and a shared MESOR<a class="anchor" aria-label="anchor" href="#specifying-a-single-component-model-with-a-grouping-variable-and-a-shared-mesor"></a>
</h3>
<p>Now, we can add a grouping variable by adding the name of the group in the <code><a href="../reference/amp_acro.html">amp_acro()</a></code> function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata_simple_gaussian</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span></span>
<span>  <span class="fl">1000</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  amp <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  acro <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata_simple_gaussian</span>,</span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span></span>
<span><span class="op">)</span></span>
<span><span class="va">object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ group:main_rrr1 + group:main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;                  Estimate</span></span>
<span><span class="co">#&gt; (Intercept)       4.47411</span></span>
<span><span class="co">#&gt; group0:main_rrr1  1.03269</span></span>
<span><span class="co">#&gt; group1:main_rrr1  0.90210</span></span>
<span><span class="co">#&gt; group0:main_sss1  1.67745</span></span>
<span><span class="co">#&gt; group1:main_sss1  0.48497</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;               Estimate</span></span>
<span><span class="co">#&gt; (Intercept)    4.47411</span></span>
<span><span class="co">#&gt; [group=0]:amp  1.96985</span></span>
<span><span class="co">#&gt; [group=1]:amp  1.02419</span></span>
<span><span class="co">#&gt; [group=0]:acr  1.01896</span></span>
<span><span class="co">#&gt; [group=1]:acr  0.49327</span></span></code></pre></div>
<p>In the example above, the amplitude and phase are being estimated separately for the two groups but the <strong>intercept term is shared</strong>. This represents a shared estimate of the MESOR for both groups and is useful if two groups are known to have a common baseline (or equilibrium point). Hence, we would interpret the transformed coefficients as follows:</p>
<ul>
<li><p>The MESOR estimate is 4.47411 for both <code>group = 0</code> and <code>group = 1</code>.</p></li>
<li><p>The estimates for amplitude and acrophase are with reference to the a MESOR estimate of 4.47411</p></li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre></div>
<p><img src="model-specification_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>However, the groups in this dataset were simulated with two different MESORs, and so it would be more appropriate to specify an intercept term in the formula, as this will estimate the MESOR for both <code>group = 0</code> and <code>group = 1</code>:</p>
</div>
<div class="section level3">
<h3 id="specifying-a-single-component-model-with-a-grouping-variable-and-an-intercept-mesor">Specifying a single-component model with a grouping variable and an intercept (MESOR)<a class="anchor" aria-label="anchor" href="#specifying-a-single-component-model-with-a-grouping-variable-and-an-intercept-mesor"></a>
</h3>
<p>Similarly to a normal regression model with <a href="https://github.com/lme4/lme4/" class="external-link">lme4</a> or <a href="https://github.com/glmmTMB/glmmTMB" class="external-link">glmmTMB</a>, we can add a term for the group in the model so that we can estimate the <strong>difference in MESOR</strong> between the two groups.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata_simple_gaussian</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ group + group:main_rrr1 + group:main_sss1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;                  Estimate</span></span>
<span><span class="co">#&gt; (Intercept)       4.96476</span></span>
<span><span class="co">#&gt; group1           -0.98129</span></span>
<span><span class="co">#&gt; group0:main_rrr1  1.04667</span></span>
<span><span class="co">#&gt; group1:main_rrr1  0.88812</span></span>
<span><span class="co">#&gt; group0:main_sss1  1.68266</span></span>
<span><span class="co">#&gt; group1:main_sss1  0.47976</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;               Estimate</span></span>
<span><span class="co">#&gt; (Intercept)    4.96476</span></span>
<span><span class="co">#&gt; [group=1]     -0.98129</span></span>
<span><span class="co">#&gt; [group=0]:amp  1.98163</span></span>
<span><span class="co">#&gt; [group=1]:amp  1.00942</span></span>
<span><span class="co">#&gt; [group=0]:acr  1.01433</span></span>
<span><span class="co">#&gt; [group=1]:acr  0.49529</span></span></code></pre></div>
<p>This is the same dataset used in the previous example, but note the following differences:</p>
<ul>
<li><p>The MESOR estimate for the reference group (<code>group = 0</code>) is given by <code>(Intercept) = 4.96476</code></p></li>
<li><p>The estimate for the difference between the MESOR of the reference group (<code>group = 0</code>) and the treatment group (<code>group = 1</code>) is given by <code>[group=1] = -0.98129</code>. As such, the estimate for the MESOR of <code>group = 1</code> is <code>3.98347</code>.</p></li>
<li><p>The estimates for amplitude and acrophase are slightly different to the previous example because there is no longer a shared MESOR.</p></li>
</ul>
<p>Plotting this model and comparing to the previous model which used the same dataset, one can appreciate the importance of specifying the formula correctly in order to gain the most accurate model.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre></div>
<p><img src="model-specification_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>We may also be interested in estimating the MESOR for the two groups separately, rather than the difference between groups. To achieve this, we can remove the intercept term by using <code>0 +</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="fl">0</span> <span class="op">+</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata_simple</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ group + group:main_rrr1 + group:main_sss1 - 1 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;                  Estimate</span></span>
<span><span class="co">#&gt; group0            4.99845</span></span>
<span><span class="co">#&gt; group1            3.99631</span></span>
<span><span class="co">#&gt; group0:main_rrr1  1.08228</span></span>
<span><span class="co">#&gt; group1:main_rrr1  0.87665</span></span>
<span><span class="co">#&gt; group0:main_sss1  1.68235</span></span>
<span><span class="co">#&gt; group1:main_sss1  0.48195</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;               Estimate</span></span>
<span><span class="co">#&gt; [group=0]      4.99845</span></span>
<span><span class="co">#&gt; [group=1]      3.99631</span></span>
<span><span class="co">#&gt; [group=0]:amp  2.00041</span></span>
<span><span class="co">#&gt; [group=1]:amp  1.00040</span></span>
<span><span class="co">#&gt; [group=0]:acr  0.99913</span></span>
<span><span class="co">#&gt; [group=1]:acr  0.50266</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="specifying-more-complicated-models-using-the-amp_acro-function">Specifying more complicated models using the <code>amp_acro()</code> function<a class="anchor" aria-label="anchor" href="#specifying-more-complicated-models-using-the-amp_acro-function"></a>
</h3>
<p>The <code><a href="../reference/amp_acro.html">amp_acro()</a></code> function controls the cosinor components of model (specifically, this affects just the fixed-effects part). It provides the user with the ability to specify grouping structures, the period of the rhythm, and the number of components. There are several arguments that the user must specify:</p>
<ul>
<li><p><code>group</code> is the name of the grouping variable in the dataset. This can be a string or an object</p></li>
<li><p><code>time_col</code> is the name of the time column in the dataset. This can be a string or an object</p></li>
<li><p><code>n_components</code> is the number of components.</p></li>
</ul>
<p>If the user wishes to fit a multicomponent cosinor model, they can specify the number of components using the <code>n_components</code> variable. The value of <code>n_components</code> will need to match the length of the <code>group</code> and <code>period</code> arguments as these will be combined for each component.</p>
<p>For example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata_two_components</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span></span>
<span>  <span class="fl">1000</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4.4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  beta.group <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span></span>
<span>    time_col <span class="op">=</span> <span class="va">times</span>,</span>
<span>    n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span>, <span class="st">"group"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata_two_components</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ group + group:main_rrr1 + group:main_sss1 + group:main_rrr2 +      group:main_sss2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;                  Estimate</span></span>
<span><span class="co">#&gt; (Intercept)       7.00043</span></span>
<span><span class="co">#&gt; group1           -2.60739</span></span>
<span><span class="co">#&gt; group0:main_rrr1  0.05665</span></span>
<span><span class="co">#&gt; group1:main_rrr1  1.08270</span></span>
<span><span class="co">#&gt; group0:main_sss1  0.08378</span></span>
<span><span class="co">#&gt; group1:main_sss1  1.68926</span></span>
<span><span class="co">#&gt; group0:main_rrr2  0.02884</span></span>
<span><span class="co">#&gt; group1:main_rrr2  0.07367</span></span>
<span><span class="co">#&gt; group0:main_sss2  0.39671</span></span>
<span><span class="co">#&gt; group1:main_sss2 -0.99891</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;                Estimate</span></span>
<span><span class="co">#&gt; (Intercept)     7.00043</span></span>
<span><span class="co">#&gt; [group=1]      -2.60739</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.10113</span></span>
<span><span class="co">#&gt; [group=1]:amp1  2.00645</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.39776</span></span>
<span><span class="co">#&gt; [group=1]:amp2  1.00162</span></span>
<span><span class="co">#&gt; [group=0]:acr1  0.97624</span></span>
<span><span class="co">#&gt; [group=1]:acr1  1.00082</span></span>
<span><span class="co">#&gt; [group=0]:acr2  1.49824</span></span>
<span><span class="co">#&gt; [group=1]:acr2 -1.49718</span></span></code></pre></div>
<p>In the output, the suffix on the estimates for amplitude and acrophase represents its component:</p>
<ul>
<li><p><code>[group=0]:amp1 = 0.10113</code> represents the estimate for amplitude of <code>group 0</code> for the first component</p></li>
<li><p><code>[group=1]:amp1 = 2.00645</code> represents the estimate for amplitude of <code>group 1</code> for the first component</p></li>
<li><p><code>[group=0]:amp2 = 0.39776</code> represents the estimate for amplitude of <code>group 0</code> for the second component</p></li>
<li><p><code>[group=1]:amp2 = 1.00162</code> represents the estimate for amplitude of <code>group 1</code> for the second component</p></li>
<li><p><em>Similarly for acrophase estimates</em></p></li>
</ul>
<p>If a multicomponent model has one component that is grouped with other components that aren’t, the vector input for <code>group</code> must still be the same length as <code>n_components</code> but have the non-grouped components represented as <code>group = NA</code>.</p>
<p>For example, if we wanted only the first component to have a grouped component, we would specify the <code>group</code> argument as <code>group = c("group", NA))</code>.</p>
<p>For a detailed explanation of how to specify multi-component models, see <a href="https://docs.ropensci.org/GLMMcosinor/articles/multiple-components.html">multiple-components</a></p>
</div>
<div class="section level3">
<h3 id="dispersion-and-zero-inflation-model-specification">Dispersion and zero-inflation model specification<a class="anchor" aria-label="anchor" href="#dispersion-and-zero-inflation-model-specification"></a>
</h3>
<p>The <code><a href="../reference/cglmm.html">cglmm()</a></code> function allows users to specify formulas for dispersion and zero-inflation models. These formulas are independent of the main formula specification:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">testdata_disp_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_cosinor.html">simulate_cosinor</a></span><span class="op">(</span><span class="fl">1000</span>,</span>
<span>  n_period <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  mesor <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  beta.mesor <span class="op">=</span> <span class="fl">4.4</span>,</span>
<span>  beta.amp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>  beta.acro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gaussian"</span>,</span>
<span>  period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>  n_components <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="va">object_disp_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    n_components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata_disp_zi</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dispformula <span class="op">=</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    n_components <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>    period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">6</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  ziformula <span class="op">=</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    n_components <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>    period <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">object_disp_zi</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw formula: </span></span>
<span><span class="co">#&gt; Y ~ group + group:main_rrr1 + group:main_sss1 + group:main_rrr2 +      group:main_sss2 + group:main_rrr3 + group:main_sss3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw Coefficients: </span></span>
<span><span class="co">#&gt;                  Estimate</span></span>
<span><span class="co">#&gt; (Intercept)       7.02271</span></span>
<span><span class="co">#&gt; group1           -2.57378</span></span>
<span><span class="co">#&gt; group0:main_rrr1  0.07665</span></span>
<span><span class="co">#&gt; group1:main_rrr1  1.03806</span></span>
<span><span class="co">#&gt; group0:main_sss1  0.13332</span></span>
<span><span class="co">#&gt; group1:main_sss1  1.73476</span></span>
<span><span class="co">#&gt; group0:main_rrr2  0.03445</span></span>
<span><span class="co">#&gt; group1:main_rrr2  0.08742</span></span>
<span><span class="co">#&gt; group0:main_sss2  0.40833</span></span>
<span><span class="co">#&gt; group1:main_sss2 -0.92989</span></span>
<span><span class="co">#&gt; group0:main_rrr3  0.48725</span></span>
<span><span class="co">#&gt; group1:main_rrr3  0.19572</span></span>
<span><span class="co">#&gt; group0:main_sss3  0.05023</span></span>
<span><span class="co">#&gt; group1:main_sss3 -0.36315</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed Coefficients: </span></span>
<span><span class="co">#&gt;                Estimate</span></span>
<span><span class="co">#&gt; (Intercept)     7.02271</span></span>
<span><span class="co">#&gt; [group=1]      -2.57378</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.15378</span></span>
<span><span class="co">#&gt; [group=1]:amp1  2.02163</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.40978</span></span>
<span><span class="co">#&gt; [group=1]:amp2  0.93399</span></span>
<span><span class="co">#&gt; [group=0]:amp3  0.48983</span></span>
<span><span class="co">#&gt; [group=1]:amp3  0.41253</span></span>
<span><span class="co">#&gt; [group=0]:acr1  1.04904</span></span>
<span><span class="co">#&gt; [group=1]:acr1  1.03156</span></span>
<span><span class="co">#&gt; [group=0]:acr2  1.48662</span></span>
<span><span class="co">#&gt; [group=1]:acr2 -1.47706</span></span>
<span><span class="co">#&gt; [group=0]:acr3  0.10272</span></span>
<span><span class="co">#&gt; [group=1]:acr3 -1.07647</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Dispersion Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw  Formula: </span></span>
<span><span class="co">#&gt; ~group + group:disp_rrr1 + group:disp_sss1 + group:disp_rrr2 +      group:disp_sss2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw  Coefficients: </span></span>
<span><span class="co">#&gt;                  Estimate</span></span>
<span><span class="co">#&gt; (Intercept)      -0.03902</span></span>
<span><span class="co">#&gt; group1            0.04129</span></span>
<span><span class="co">#&gt; group0:disp_rrr1  0.04352</span></span>
<span><span class="co">#&gt; group1:disp_rrr1  0.06807</span></span>
<span><span class="co">#&gt; group0:disp_sss1 -0.00523</span></span>
<span><span class="co">#&gt; group1:disp_sss1  0.03091</span></span>
<span><span class="co">#&gt; group0:disp_rrr2  0.12144</span></span>
<span><span class="co">#&gt; group1:disp_rrr2 -0.04036</span></span>
<span><span class="co">#&gt; group0:disp_sss2 -0.04345</span></span>
<span><span class="co">#&gt; group1:disp_sss2  0.10440</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed  Coefficients: </span></span>
<span><span class="co">#&gt;                Estimate</span></span>
<span><span class="co">#&gt; (Intercept)    -0.03902</span></span>
<span><span class="co">#&gt; [group=1]       0.04129</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.04383</span></span>
<span><span class="co">#&gt; [group=1]:amp1  0.07476</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.12898</span></span>
<span><span class="co">#&gt; [group=1]:amp2  0.11193</span></span>
<span><span class="co">#&gt; [group=0]:acr1 -0.11970</span></span>
<span><span class="co">#&gt; [group=1]:acr1  0.42631</span></span>
<span><span class="co">#&gt; [group=0]:acr2 -0.34359</span></span>
<span><span class="co">#&gt; [group=1]:acr2  1.93968</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Zero-Inflation Model </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw  Formula: </span></span>
<span><span class="co">#&gt; ~group + group:zi_rrr1 + group:zi_sss1 + group:zi_rrr2 + group:zi_sss2 +      group:zi_rrr3 + group:zi_sss3 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Raw  Coefficients: </span></span>
<span><span class="co">#&gt;                 Estimate</span></span>
<span><span class="co">#&gt; (Intercept)    -21.99783</span></span>
<span><span class="co">#&gt; group1          -1.73577</span></span>
<span><span class="co">#&gt; group0:zi_rrr1   0.02407</span></span>
<span><span class="co">#&gt; group1:zi_rrr1  -0.00158</span></span>
<span><span class="co">#&gt; group0:zi_sss1  -0.00243</span></span>
<span><span class="co">#&gt; group1:zi_sss1   0.00077</span></span>
<span><span class="co">#&gt; group0:zi_rrr2   0.05699</span></span>
<span><span class="co">#&gt; group1:zi_rrr2   0.00306</span></span>
<span><span class="co">#&gt; group0:zi_sss2  -0.09301</span></span>
<span><span class="co">#&gt; group1:zi_sss2  -0.00581</span></span>
<span><span class="co">#&gt; group0:zi_rrr3   0.00144</span></span>
<span><span class="co">#&gt; group1:zi_rrr3  -0.00053</span></span>
<span><span class="co">#&gt; group0:zi_sss3   0.00432</span></span>
<span><span class="co">#&gt; group1:zi_sss3   0.00035</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Transformed  Coefficients: </span></span>
<span><span class="co">#&gt;                 Estimate</span></span>
<span><span class="co">#&gt; (Intercept)    -21.99783</span></span>
<span><span class="co">#&gt; [group=1]       -1.73577</span></span>
<span><span class="co">#&gt; [group=0]:amp1   0.02419</span></span>
<span><span class="co">#&gt; [group=1]:amp1   0.00175</span></span>
<span><span class="co">#&gt; [group=0]:amp2   0.10908</span></span>
<span><span class="co">#&gt; [group=1]:amp2   0.00657</span></span>
<span><span class="co">#&gt; [group=0]:amp3   0.00455</span></span>
<span><span class="co">#&gt; [group=1]:amp3   0.00064</span></span>
<span><span class="co">#&gt; [group=0]:acr1  -0.10071</span></span>
<span><span class="co">#&gt; [group=1]:acr1   2.68720</span></span>
<span><span class="co">#&gt; [group=0]:acr2  -1.02107</span></span>
<span><span class="co">#&gt; [group=1]:acr2  -1.08621</span></span>
<span><span class="co">#&gt; [group=0]:acr3   1.24900</span></span>
<span><span class="co">#&gt; [group=1]:acr3   2.55758</span></span></code></pre></div>
<p>The output provides estimates for conditional model (default model), the dispersion model, and also the zero-inflation model. By default, <code>dispformula = ~1</code>, and <code>ziformula = ~0</code> which means these additional models will not be generated in the output.</p>
<p><em>Note that in the example above, the value for the periods and the number of components in the dispersion and zero-inflation formulas were chosen arbitrarily and purely for demonstration.</em></p>
</div>
</div>
<div class="section level2">
<h2 id="using-summarycglmm">Using <code>summary(cglmm)</code><a class="anchor" aria-label="anchor" href="#using-summarycglmm"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method for <code>cglmm</code> objects provides a more detailed summary of the model and its parameter estimates and uncertainty. It outputs the estimates, standard errors, confidence intervals, and <span class="math inline">\(p\)</span>-values for both the raw model parameters and the transformed parameters. The summary statistics do not represent a comparison between any groups for the cosinor components - that is the role of the <code>test_cosinor()</code> function.</p>
<p>Here is an example of how to use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cglmm.html">cglmm</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op">~</span> <span class="va">group</span> <span class="op">+</span> <span class="fu"><a href="../reference/amp_acro.html">amp_acro</a></span><span class="op">(</span><span class="va">times</span>,</span>
<span>    period <span class="op">=</span> <span class="fl">12</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"group"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">testdata_simple</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                      estimate standard.error     lower.CI upper.CI    p.value</span></span>
<span><span class="co">#&gt; (Intercept)       4.998454142    0.003463730  4.991665356  5.00524 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1           -1.002150001    0.005937109 -1.013786521 -0.99051 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr1  1.082281784    0.003347565  1.075720677  1.08884 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_rrr1  0.876651963    0.006198710  0.864502714  0.88880 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_sss1  1.682350718    0.003919418  1.674668800  1.69003 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss1  0.481951763    0.005936670  0.470316104  0.49359 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt;                     </span></span>
<span><span class="co">#&gt; (Intercept)      ***</span></span>
<span><span class="co">#&gt; group1           ***</span></span>
<span><span class="co">#&gt; group0:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group0:main_sss1 ***</span></span>
<span><span class="co">#&gt; group1:main_sss1 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                    estimate standard.error     lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)     4.998454142    0.003463730  4.991665356  5.00524 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]      -1.002150001    0.005937109 -1.013786521 -0.99051 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp1  2.000409408    0.004275553  1.992029478  2.00879 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp1  1.000398004    0.006379631  0.987894156  1.01290 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr1  0.999134804    0.001439122  0.996314177  1.00196 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr1  0.502662067    0.005739524  0.491412807  0.51391 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The summary statistics for dispersion and zero-inflation models will also be provided by the <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function, if the original <code>cglmm</code> object being analysed contains them. The following demonstration uses the model specified in the <strong>Dispersion and Zero-inflation model specification</strong> section of this vignette:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object_disp_zi</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Conditional Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                       estimate standard.error      lower.CI upper.CI    p.value</span></span>
<span><span class="co">#&gt; (Intercept)       7.0227087795   0.0312397675  6.9614799603  7.08394 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1           -2.5737779568   0.0447282979 -2.6614438098 -2.48611 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr1  0.0766463165   0.0446340220 -0.0108347592  0.16413  0.0859395</span></span>
<span><span class="co">#&gt; group1:main_rrr1  1.0380627066   0.0436976240  0.9524169373  1.12371 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_sss1  0.1333208608   0.0436103341  0.0478461766  0.21880  0.0022349</span></span>
<span><span class="co">#&gt; group1:main_sss1  1.7347611923   0.0463222431  1.6439712641  1.82555 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr2  0.0344545570   0.0439449834 -0.0516760277  0.12059  0.4330175</span></span>
<span><span class="co">#&gt; group1:main_rrr2  0.0874167845   0.0446621499 -0.0001194207  0.17495  0.0503134</span></span>
<span><span class="co">#&gt; group0:main_sss2  0.4083266253   0.0444126044  0.3212795201  0.49537 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_sss2 -0.9298851066   0.0452305737 -1.0185354020 -0.84123 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group0:main_rrr3  0.4872500484   0.0435896051  0.4018159923  0.57268 &lt; 2.22e-16</span></span>
<span><span class="co">#&gt; group1:main_rrr3  0.1957192961   0.0441170731  0.1092514217  0.28219 9.1492e-06</span></span>
<span><span class="co">#&gt; group0:main_sss3  0.0502278217   0.0449846472 -0.0379404668  0.13840  0.2641847</span></span>
<span><span class="co">#&gt; group1:main_sss3 -0.3631455072   0.0456967619 -0.4527095147 -0.27358 1.9131e-15</span></span>
<span><span class="co">#&gt;                     </span></span>
<span><span class="co">#&gt; (Intercept)      ***</span></span>
<span><span class="co">#&gt; group1           ***</span></span>
<span><span class="co">#&gt; group0:main_rrr1 .  </span></span>
<span><span class="co">#&gt; group1:main_rrr1 ***</span></span>
<span><span class="co">#&gt; group0:main_sss1 ** </span></span>
<span><span class="co">#&gt; group1:main_sss1 ***</span></span>
<span><span class="co">#&gt; group0:main_rrr2    </span></span>
<span><span class="co">#&gt; group1:main_rrr2 .  </span></span>
<span><span class="co">#&gt; group0:main_sss2 ***</span></span>
<span><span class="co">#&gt; group1:main_sss2 ***</span></span>
<span><span class="co">#&gt; group0:main_rrr3 ***</span></span>
<span><span class="co">#&gt; group1:main_rrr3 ***</span></span>
<span><span class="co">#&gt; group0:main_sss3    </span></span>
<span><span class="co">#&gt; group1:main_sss3 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                   estimate standard.error    lower.CI upper.CI    p.value    </span></span>
<span><span class="co">#&gt; (Intercept)     7.02270878     0.03123977  6.96147996  7.08394 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]      -2.57377796     0.04472830 -2.66144381 -2.48611 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.15378267     0.04378626  0.06796318  0.23960 0.00044454 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp1  2.02162573     0.04697415  1.92955809  2.11369 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.40977768     0.04441355  0.32272872  0.49683 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp2  0.93398501     0.04524136  0.84531358  1.02266 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:amp3  0.48983206     0.04369744  0.40418665  0.57548 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:amp3  0.41252964     0.04521816  0.32390367  0.50116 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr1  1.04903634     0.28911874  0.48237403  1.61570 0.00028519 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr1  1.03156193     0.02126807  0.98987729  1.07325 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr2  1.48661584     0.10723870  1.27643185  1.69680 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=1]:acr2 -1.47706364     0.04780722 -1.57076407 -1.38336 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; [group=0]:acr3  0.10272146     0.09162305 -0.07685642  0.28230 0.26223204    </span></span>
<span><span class="co">#&gt; [group=1]:acr3 -1.07647204     0.10813160 -1.28840609 -0.86454 &lt; 2.22e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Dispersion Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                      estimate standard.error     lower.CI upper.CI  p.value  </span></span>
<span><span class="co">#&gt; (Intercept)      -0.039019462    0.044845582 -0.126915188  0.04888 0.384254  </span></span>
<span><span class="co">#&gt; group1            0.041287329    0.063417288 -0.083008271  0.16558 0.515019  </span></span>
<span><span class="co">#&gt; group0:disp_rrr1  0.043520801    0.062560056 -0.079094656  0.16614 0.486639  </span></span>
<span><span class="co">#&gt; group1:disp_rrr1  0.068065083    0.062255918 -0.053954274  0.19008 0.274257  </span></span>
<span><span class="co">#&gt; group0:disp_sss1 -0.005234420    0.064812929 -0.132265425  0.12180 0.935631  </span></span>
<span><span class="co">#&gt; group1:disp_sss1  0.030912766    0.064768682 -0.096031517  0.15786 0.633163  </span></span>
<span><span class="co">#&gt; group0:disp_rrr2  0.121444128    0.066012188 -0.007937384  0.25083 0.065809 .</span></span>
<span><span class="co">#&gt; group1:disp_rrr2 -0.040358995    0.062751765 -0.163350195  0.08263 0.520125  </span></span>
<span><span class="co">#&gt; group0:disp_sss2 -0.043449939    0.061879843 -0.164732203  0.07783 0.482575  </span></span>
<span><span class="co">#&gt; group1:disp_sss2  0.104401357    0.064430875 -0.021880837  0.23068 0.105154  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                     estimate standard.error      lower.CI upper.CI    p.value</span></span>
<span><span class="co">#&gt; (Intercept)    -0.0390194624   0.0448455818 -0.1269151877  0.04888 0.38425402</span></span>
<span><span class="co">#&gt; [group=1]       0.0412873286   0.0634172876 -0.0830082712  0.16558 0.51501926</span></span>
<span><span class="co">#&gt; [group=0]:amp1  0.0438344529   0.0624873107 -0.0786384255  0.16631 0.48299498</span></span>
<span><span class="co">#&gt; [group=1]:amp1  0.0747559668   0.0630966153 -0.0489111268  0.19842 0.23610219</span></span>
<span><span class="co">#&gt; [group=0]:amp2  0.1289828418   0.0657505788  0.0001140755  0.25785 0.04979754</span></span>
<span><span class="co">#&gt; [group=1]:amp2  0.1119307463   0.0645473418 -0.0145797190  0.23844 0.08290254</span></span>
<span><span class="co">#&gt; [group=0]:acr1 -0.1196989992   1.4801842434 -3.0208068068  2.78141 0.93554722</span></span>
<span><span class="co">#&gt; [group=1]:acr1  0.4263119866   0.8554496931 -1.2503386024  2.10296 0.61823850</span></span>
<span><span class="co">#&gt; [group=0]:acr2 -0.3435864062   0.4819070901 -1.2881069468  0.60093 0.47586290</span></span>
<span><span class="co">#&gt; [group=1]:acr2  1.9396764654   0.5595599199  0.8429591751  3.03639 0.00052741</span></span>
<span><span class="co">#&gt;                   </span></span>
<span><span class="co">#&gt; (Intercept)       </span></span>
<span><span class="co">#&gt; [group=1]         </span></span>
<span><span class="co">#&gt; [group=0]:amp1    </span></span>
<span><span class="co">#&gt; [group=1]:amp1    </span></span>
<span><span class="co">#&gt; [group=0]:amp2 *  </span></span>
<span><span class="co">#&gt; [group=1]:amp2 .  </span></span>
<span><span class="co">#&gt; [group=0]:acr1    </span></span>
<span><span class="co">#&gt; [group=1]:acr1    </span></span>
<span><span class="co">#&gt; [group=0]:acr2    </span></span>
<span><span class="co">#&gt; [group=1]:acr2 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ***********************</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Zero-Inflation Model </span></span>
<span><span class="co">#&gt; Raw model coefficients:</span></span>
<span><span class="co">#&gt;                     estimate standard.error      lower.CI  upper.CI p.value</span></span>
<span><span class="co">#&gt; (Intercept)    -2.199783e+01   1.895965e+03 -3.738020e+03  3694.025 0.99074</span></span>
<span><span class="co">#&gt; group1         -1.735766e+00   4.906674e+03 -9.618639e+03  9615.168 0.99972</span></span>
<span><span class="co">#&gt; group0:zi_rrr1  2.406830e-02   2.753689e+03 -5.397107e+03  5397.155 0.99999</span></span>
<span><span class="co">#&gt; group1:zi_rrr1 -1.576363e-03   6.547136e+03 -1.283215e+04 12832.149 1.00000</span></span>
<span><span class="co">#&gt; group0:zi_sss1 -2.432258e-03   2.754071e+03 -5.397883e+03  5397.878 1.00000</span></span>
<span><span class="co">#&gt; group1:zi_sss1  7.700353e-04   6.553009e+03 -1.284366e+04 12843.663 1.00000</span></span>
<span><span class="co">#&gt; group0:zi_rrr2  5.698847e-02   2.709906e+03 -5.311262e+03  5311.376 0.99998</span></span>
<span><span class="co">#&gt; group1:zi_rrr2  3.061333e-03   6.448766e+03 -1.263935e+04 12639.353 1.00000</span></span>
<span><span class="co">#&gt; group0:zi_sss2 -9.300763e-02   2.797023e+03 -5.482157e+03  5481.971 0.99997</span></span>
<span><span class="co">#&gt; group1:zi_sss2 -5.814997e-03   6.672906e+03 -1.307866e+04 13078.650 1.00000</span></span>
<span><span class="co">#&gt; group0:zi_rrr3  1.439422e-03   2.667475e+03 -5.228153e+03  5228.155 1.00000</span></span>
<span><span class="co">#&gt; group1:zi_rrr3 -5.335188e-04   6.342152e+03 -1.243039e+04 12430.390 1.00000</span></span>
<span><span class="co">#&gt; group0:zi_sss3  4.317650e-03   2.707171e+03 -5.305954e+03  5305.962 1.00000</span></span>
<span><span class="co">#&gt; group1:zi_sss3  3.526141e-04   6.431923e+03 -1.260634e+04 12606.337 1.00000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed coefficients:</span></span>
<span><span class="co">#&gt;                     estimate standard.error      lower.CI     upper.CI p.value</span></span>
<span><span class="co">#&gt; (Intercept)    -2.199783e+01   1.895965e+03 -3.738020e+03     3694.025 0.99074</span></span>
<span><span class="co">#&gt; [group=1]      -1.735766e+00   4.906674e+03 -9.618639e+03     9615.168 0.99972</span></span>
<span><span class="co">#&gt; [group=0]:amp1  2.419089e-02   2.765077e+03 -5.419426e+03     5419.475 0.99999</span></span>
<span><span class="co">#&gt; [group=1]:amp1  1.754387e-03   6.656983e+03 -1.304744e+04    13047.448 1.00000</span></span>
<span><span class="co">#&gt; [group=0]:amp2  1.090784e-01   2.771797e+03 -5.432513e+03     5432.731 0.99997</span></span>
<span><span class="co">#&gt; [group=1]:amp2  6.571602e-03   6.618290e+03 -1.297160e+04    12971.618 1.00000</span></span>
<span><span class="co">#&gt; [group=0]:amp3  4.551268e-03   2.710590e+03 -5.312655e+03     5312.664 1.00000</span></span>
<span><span class="co">#&gt; [group=1]:amp3  6.395147e-04   6.340239e+03 -1.242664e+04    12426.640 1.00000</span></span>
<span><span class="co">#&gt; [group=0]:acr1 -1.007146e-01   1.133748e+05 -2.222107e+05   222210.489 1.00000</span></span>
<span><span class="co">#&gt; [group=1]:acr1  2.687197e+00   3.671589e+06 -7.196179e+06  7196184.787 1.00000</span></span>
<span><span class="co">#&gt; [group=0]:acr2 -1.021070e+00   2.508015e+04 -4.915721e+04    49155.163 0.99997</span></span>
<span><span class="co">#&gt; [group=1]:acr2 -1.086210e+00   9.898356e+05 -1.940043e+06  1940041.052 1.00000</span></span>
<span><span class="co">#&gt; [group=0]:acr3  1.249003e+00   5.853315e+05 -1.147227e+06  1147229.843 1.00000</span></span>
<span><span class="co">#&gt; [group=1]:acr3  2.557578e+00   1.006046e+07 -1.971813e+07 19718133.562 1.00000</span></span></code></pre></div>
<p><em>Note that this dataset was not simulated with consideration of dispersion or zero-inflation characteristics, hence the lack of significant P-values in the model summary for the dispersion and zero-inflation models.</em></p>
</div>
<div class="section level2">
<h2 id="assessing-residual-diagnostics-of-cglmm-regression-models-using-dharma">Assessing residual diagnostics of <code>cglmm</code> regression models using DHARMa<a class="anchor" aria-label="anchor" href="#assessing-residual-diagnostics-of-cglmm-regression-models-using-dharma"></a>
</h2>
<p><a href="http://florianhartig.github.io/DHARMa/" class="external-link">DHARMa</a> is an R package used to assess residual diagnostics of regression models fit using <a href="https://github.com/glmmTMB/glmmTMB" class="external-link">glmmTMB</a> (which is what is used by <code><a href="../reference/cglmm.html">cglmm()</a></code>).</p>
<p>For example, we can apply the functions from <code>DHARMa</code> on the <code>glmmTMB</code> model within by accessing it with <code>$fit</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://florianhartig.github.io/DHARMa/" class="external-link">DHARMa</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; This is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/plotResiduals.html" class="external-link">plotResiduals</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/simulateResiduals.html" class="external-link">simulateResiduals</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="model-specification_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/plotQQunif.html" class="external-link">plotQQunif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/DHARMa/man/simulateResiduals.html" class="external-link">simulateResiduals</a></span><span class="op">(</span><span class="va">object</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="model-specification_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
